% Test the generation of a 64-node hexahedral block.
[fens,fes] = H64_block(5,3,1,1,1,1);
node_pc(1,:)=[-1,-1,-1];
node_pc(2,:)=[-0.333333333333333,-1,-1];
node_pc(3,:)=[0.333333333333333,-1,-1];
node_pc(4,:)=[1,-1,-1];
node_pc(5,:)=[-1,-0.333333333333333,-1];
node_pc(6,:)=[-0.333333333333333,-0.333333333333333,-1];
node_pc(7,:)=[0.333333333333333,-0.333333333333333,-1];
node_pc(8,:)=[1,-0.333333333333333,-1];
node_pc(9,:)=[-1,0.333333333333333,-1];
node_pc(10,:)=[-0.333333333333333,0.333333333333333,-1];
node_pc(11,:)=[0.333333333333333,0.333333333333333,-1];
node_pc(12,:)=[1,0.333333333333333,-1];
node_pc(13,:)=[-1,1,-1];
node_pc(14,:)=[-0.333333333333333,1,-1];
node_pc(15,:)=[0.333333333333333,1,-1];
node_pc(16,:)=[1,1,-1];
node_pc(17,:)=[-1,-1,-0.333333333333333];
node_pc(18,:)=[-0.333333333333333,-1,-0.333333333333333];
node_pc(19,:)=[0.333333333333333,-1,-0.333333333333333];
node_pc(20,:)=[1,-1,-0.333333333333333];
node_pc(21,:)=[-1,-0.333333333333333,-0.333333333333333];
node_pc(22,:)=[-0.333333333333333,-0.333333333333333,-0.333333333333333];
node_pc(23,:)=[0.333333333333333,-0.333333333333333,-0.333333333333333];
node_pc(24,:)=[1,-0.333333333333333,-0.333333333333333];
node_pc(25,:)=[-1,0.333333333333333,-0.333333333333333];
node_pc(26,:)=[-0.333333333333333,0.333333333333333,-0.333333333333333];
node_pc(27,:)=[0.333333333333333,0.333333333333333,-0.333333333333333];
node_pc(28,:)=[1,0.333333333333333,-0.333333333333333];
node_pc(29,:)=[-1,1,-0.333333333333333];
node_pc(30,:)=[-0.333333333333333,1,-0.333333333333333];
node_pc(31,:)=[0.333333333333333,1,-0.333333333333333];
node_pc(32,:)=[1,1,-0.333333333333333];
node_pc(33,:)=[-1,-1,0.333333333333333];
node_pc(34,:)=[-0.333333333333333,-1,0.333333333333333];
node_pc(35,:)=[0.333333333333333,-1,0.333333333333333];
node_pc(36,:)=[1,-1,0.333333333333333];
node_pc(37,:)=[-1,-0.333333333333333,0.333333333333333];
node_pc(38,:)=[-0.333333333333333,-0.333333333333333,0.333333333333333];
node_pc(39,:)=[0.333333333333333,-0.333333333333333,0.333333333333333];
node_pc(40,:)=[1,-0.333333333333333,0.333333333333333];
node_pc(41,:)=[-1,0.333333333333333,0.333333333333333];
node_pc(42,:)=[-0.333333333333333,0.333333333333333,0.333333333333333];
node_pc(43,:)=[0.333333333333333,0.333333333333333,0.333333333333333];
node_pc(44,:)=[1,0.333333333333333,0.333333333333333];
node_pc(45,:)=[-1,1,0.333333333333333];
node_pc(46,:)=[-0.333333333333333,1,0.333333333333333];
node_pc(47,:)=[0.333333333333333,1,0.333333333333333];
node_pc(48,:)=[1,1,0.333333333333333];
node_pc(49,:)=[-1,-1,1];
node_pc(50,:)=[-0.333333333333333,-1,1];
node_pc(51,:)=[0.333333333333333,-1,1];
node_pc(52,:)=[1,-1,1];
node_pc(53,:)=[-1,-0.333333333333333,1];
node_pc(54,:)=[-0.333333333333333,-0.333333333333333,1];
node_pc(55,:)=[0.333333333333333,-0.333333333333333,1];
node_pc(56,:)=[1,-0.333333333333333,1];
node_pc(57,:)=[-1,0.333333333333333,1];
node_pc(58,:)=[-0.333333333333333,0.333333333333333,1];
node_pc(59,:)=[0.333333333333333,0.333333333333333,1];
node_pc(60,:)=[1,0.333333333333333,1];
node_pc(61,:)=[-1,1,1];
node_pc(62,:)=[-0.333333333333333,1,1];
node_pc(63,:)=[0.333333333333333,1,1];
node_pc(64,:)=[1,1,1];
fens.xyz= node_pc;
fes.conn=1:64;
gv=drawmesh({fens,fes},'nodes','fes','facecolor','none','offset',0.04); hold on
bg=mesh_boundary(fes);
l=[fe_select(fens,bg,struct ('facing', true, 'direction', [-1,0,0],'tolerance',0.01))];
gv=drawmesh({fens,subset(bg,l)},'gv',gv,'fes','facecolor','y'); hold on
l=[fe_select(fens,bg,struct ('facing', true, 'direction', [0,-1,0],'tolerance',0.01))];
gv=drawmesh({fens,subset(bg,l)},'gv',gv,'fes','facecolor','y'); hold on
l=[fe_select(fens,bg,struct ('facing', true, 'direction', [0,0,-1,],'tolerance',0.01))];
gv=drawmesh({fens,subset(bg,l)},'gv',gv,'fes','facecolor','y'); hold on
l=[fe_select(fens,bg,struct ('facing', true, 'direction', [+1,0,0],'tolerance',0.01))];
gv=drawmesh({fens,subset(bg,l)},'gv',gv,'fes','facecolor','r'); hold on
l=[fe_select(fens,bg,struct ('facing', true, 'direction', [0,+1,0],'tolerance',0.01))];
gv=drawmesh({fens,subset(bg,l)},'gv',gv,'fes','facecolor','g'); hold on
l=[fe_select(fens,bg,struct ('facing', true, 'direction', [0,0,+1,],'tolerance',0.01))];
gv=drawmesh({fens,subset(bg,l)},'gv',gv,'fes','facecolor','b'); hold on
labels